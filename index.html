<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">

<!-- PENTING UNTUK MOBILE -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Hagah 2026</title>
<link rel="manifest" href="manifest.json">

<style>
*{
 box-sizing:border-box;
}

body{
 background:#f05a28;
 color:white;
 font-family:Arial, sans-serif;
 text-align:center;
 margin:0;
 padding:0;
 height:100vh;
 display:flex;
 flex-direction:column;
}

/* CONTAINER */
#app{
 flex:1;
 display:flex;
 flex-direction:column;
 justify-content:center;
 align-items:center;
 padding:20px;
 width:100%;
}

/* TITLE */
#title{
 font-size:10vw; /* RESPONSIVE */
 font-weight:bold;
 letter-spacing:2px;
 margin-bottom:10px;
 text-shadow:2px 2px 6px rgba(0,0,0,.5);
}

/* SCORE */
#score{
 font-size:4vw;
 margin-bottom:10px;
}

/* NAV */
#nav{
 display:flex;
 justify-content:space-between;
 width:100%;
 max-width:500px;
 margin:10px 0;
}

.navBtn{
 width:48%;
 background:rgba(255,255,255,.25);
 border:none;
 color:white;
 padding:14px;
 border-radius:30px;
 font-size:4vw;
}

/* TEXT */
#today{
 font-size:5vw;
 line-height:1.6;
 margin:15px 0;
}

/* MAIN BUTTON */
#baca{
 width:100%;
 max-width:420px;
 background:#fff;
 color:#f05a28;
 border:none;
 padding:18px;
 font-size:5vw;
 font-weight:bold;
 border-radius:50px;
 box-shadow:0 6px 12px rgba(0,0,0,.4);
}

/* HISTORY */
#history{
 width:100%;
 max-width:500px;
 background:rgba(0,0,0,.15);
 padding:15px;
 border-radius:15px;
 font-size:3.5vw;
 text-align:left;
 margin-top:15px;
}

/* WATERMARK */
#watermark{
 font-size:3vw;
 opacity:.8;
 padding:10px 0;
}
</style>
</head>

<body>

<div id="app">

<div id="title">Hagah 2026</div>

<div id="score">Score: 0%</div>

<div id="nav">
 <button class="navBtn" onclick="changeDay(-1)">â—€ Kemarin</button>
 <button class="navBtn" onclick="changeDay(1)">Besok â–¶</button>
</div>

<div id="today">Loading...</div>

<button id="baca" onclick="openBible()">ðŸ“– BACA SEKARANG</button>

<div id="history"></div>

</div>

<div id="watermark">
GBI El Shadai - Pontianak
</div>

<script>
let currentDate=new Date();
let dataGlobal;

fetch('data.json')
.then(r=>r.json())
.then(data=>{
 dataGlobal=data;
 render();
});

/* RENDER */
function render(){
 let key=formatDate(currentDate);
 let bacaan=dataGlobal[key]||"Tidak ada data";

 document.getElementById("today").innerHTML=
 "<b>"+formatHari(currentDate)+"</b><br><br>"+
 "Pembacaan Alkitab Hari ini:<br>"+
 "<b>"+bacaan+"</b>";

 window.ref=bacaan;
 showHistory();
 calcScore();
}

/* CHANGE DAY */
function changeDay(step){
 currentDate.setDate(currentDate.getDate()+step);
 render();
}

/* OPEN */
function openBible(){
 let kitab=ref.split(" ")[0];
 let pasal=ref.match(/\d+/)[0];
 window.open("https://alkitab.mobi/tb/"+kitab+"/"+pasal);
}

/* HISTORY */
function showHistory(){
 let html="<b>Riwayat 7 Hari Terakhir</b><br><br>";
 for(let i=1;i<=7;i++){
  let d=new Date(currentDate);
  d.setDate(d.getDate()-i);
  let k=formatDate(d);
  if(dataGlobal[k])
   html+=formatHari(d)+"<br>"+dataGlobal[k]+"<br><br>";
 }
 document.getElementById("history").innerHTML=html;
}

/* SCORE */
function calcScore(){
 let start=new Date("2026-01-01");
 let today=new Date();
 let diff=Math.floor((today-start)/86400000)+1;
 let done=Math.min(diff,365);
 let percent=Math.round((done/365)*100);
 document.getElementById("score").innerHTML=
 "Progress Bacaan: <b>"+percent+"%</b>";
}

/* UTIL */
function formatDate(d){
 let y=d.getFullYear();
 let m=String(d.getMonth()+1).padStart(2,'0');
 let da=String(d.getDate()).padStart(2,'0');
 return y+"-"+m+"-"+da;
}

function formatHari(d){
 let h=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
 return h[d.getDay()]+", "+
 String(d.getDate()).padStart(2,'0')+"-"+
 String(d.getMonth()+1).padStart(2,'0')+"-"+d.getFullYear();
}

/* SWIPE */
let xStart=null;
document.addEventListener("touchstart",e=>{
 xStart=e.touches[0].clientX;
});

document.addEventListener("touchend",e=>{
 if(!xStart)return;
 let xEnd=e.changedTouches[0].clientX;
 let diff=xStart-xEnd;
 if(diff>50) changeDay(1);
 if(diff<-50) changeDay(-1);
 xStart=null;
});
</script>

</body>
</html>
